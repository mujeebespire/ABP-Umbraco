@inherits UmbracoViewPage<BlockListItem>
@using Umbraco.Cms.Core.Models.Blocks
@using Umbraco.Cms.Core.Models
@using Umbraco.Extensions

@{
    var content = Model.Content;
    var videoUrl = content.Value<string>("vedioUrl") ?? "";
    var showPopup = content.Value<bool>("enablePopup");
    var videoPlayer = content.Value<bool>("youtubePlayer"); // the toggle

    if (string.IsNullOrWhiteSpace(videoUrl))
    {
        <p style="color:red;">⚠️ Please provide a Vimeo video URL.</p>
        return;
    }
}

@if (videoPlayer)
{
    <!-- Video Inside Block -->
    <div class="video-wrapper video-wrapper--relative js-iframe-wrapper" data-mobile-height="100%">
        <div>
            <iframe src="@($"{videoUrl}?controls=0")"
                    width="100%"
                    height="500"
                    class="js-video-iframe"
                    allow="autoplay; fullscreen; picture-in-picture"
                    allowfullscreen>
            </iframe>

            <button type="button" class="btn video-wrapper__btn icon font-ico-triangle js-iframe-play">
                <span class="sr-only">Play video</span>
            </button>
        </div>

        @if (showPopup)
        {
            <div class="video-wrapper__popup js-iframe-popup">
                <span class="video-wrapper__popup-overlay js-popup-close"></span>
                <button type="button" class="video-wrapper__popup-close-btn js-popup-close">
                    <span class="font-ico-close"></span>
                    <span class="sr-only">Close video</span>
                </button>

                <iframe class="video-wrapper__popup-iframe js-popup-iframe"
                        src="@videoUrl"
                        allow="autoplay; fullscreen; picture-in-picture"
                        allowfullscreen>
                </iframe>
            </div>
        }
    </div>
}
else
{
    <!-- Full Width Video Block -->
    <div class="video-wrapper video-wrapper--relative js-iframe-wrapper js-iframe-expand"
         data-mobile-height="100%">
        <div>
            <iframe src="@($"{videoUrl}?controls=0")"
                    width="100%"
                    height="500"
                    class="js-video-iframe"
                    allow="autoplay; fullscreen; picture-in-picture"
                    allowfullscreen>
            </iframe>

            <button type="button" class="btn video-wrapper__btn icon font-ico-triangle js-iframe-play">
                <span class="sr-only">Play video</span>
            </button>
        </div>

        @if (showPopup)
        {
            <div class="video-wrapper__popup js-iframe-popup">
                <span class="video-wrapper__popup-overlay js-popup-close"></span>
                <button type="button" class="video-wrapper__popup-close-btn js-popup-close">
                    <span class="font-ico-close"></span>
                    <span class="sr-only">Close video</span>
                </button>

                <iframe class="video-wrapper__popup-iframe js-popup-iframe"
                        src="@videoUrl"
                        allow="autoplay; fullscreen; picture-in-picture"
                        allowfullscreen>
                </iframe>
            </div>
        }
    </div>
}
